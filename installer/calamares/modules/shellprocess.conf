---
# Shell commands executed inside the target system during installation.
# @@key@@ references are resolved from Calamares GlobalStorage.
#   - username: set by the users module
#
# ALL INSTALLATION SCRIPTS RUN HERE (instance syntax @ doesn't work in Calamares 3.3.14)
# Order is critical: kernel → bootloader → session → post-install
# Output is logged to /var/log/lyrah-install.log for debugging
dontChroot: false
script:
  - "/bin/bash -c 'exec 1> >(tee -a /var/log/lyrah-install.log); exec 2>&1; echo \"=== [$(date)] Starting setup-kernel.sh ===\"; /usr/share/lyrah/installer/setup-kernel.sh; echo \"=== [$(date)] Finished setup-kernel.sh (exit code: $?) ===\"'"
  - "/bin/bash -c 'exec 1> >(tee -a /var/log/lyrah-install.log); exec 2>&1; echo \"=== [$(date)] Starting install-bootloader.sh ===\"; /usr/share/lyrah/installer/install-bootloader.sh; echo \"=== [$(date)] Finished install-bootloader.sh (exit code: $?) ===\"'"
  - "/bin/bash -c 'exec 1> >(tee -a /var/log/lyrah-install.log); exec 2>&1; echo \"=== [$(date)] Starting configure-session.sh ===\"; /usr/share/lyrah/installer/configure-session.sh plasma @@username@@; echo \"=== [$(date)] Finished configure-session.sh (exit code: $?) ===\"'"
  - "/bin/bash -c 'exec 1> >(tee -a /var/log/lyrah-install.log); exec 2>&1; echo \"=== [$(date)] Starting post-install.sh ===\"; /usr/share/lyrah/installer/post-install.sh; echo \"=== [$(date)] Finished post-install.sh (exit code: $?) ===\"'"
