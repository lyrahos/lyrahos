---
# Shell commands executed inside the target system during installation.
# @@key@@ references are resolved from Calamares GlobalStorage.
#   - username: set by the users module
#
# ALL INSTALLATION SCRIPTS RUN HERE (instance syntax @ doesn't work in Calamares 3.3.14)
# Order is critical: kernel → bootloader → session → post-install
# Output is logged to /var/log/lyrah-install.log for debugging
dontChroot: false
timeout: 600
script:
  - "/bin/bash -c 'echo \"=== [$(date)] Starting setup-kernel.sh ===\" >> /var/log/lyrah-install.log 2>&1; /usr/share/lyrah/installer/setup-kernel.sh >> /var/log/lyrah-install.log 2>&1; echo \"=== [$(date)] Finished setup-kernel.sh (exit: $?) ===\" >> /var/log/lyrah-install.log 2>&1'"
  - "/bin/bash -c 'echo \"=== [$(date)] Starting install-bootloader.sh ===\" >> /var/log/lyrah-install.log 2>&1; /usr/share/lyrah/installer/install-bootloader.sh >> /var/log/lyrah-install.log 2>&1; echo \"=== [$(date)] Finished install-bootloader.sh (exit: $?) ===\" >> /var/log/lyrah-install.log 2>&1'"
  - "/bin/bash -c 'echo \"=== [$(date)] Starting configure-session.sh ===\" >> /var/log/lyrah-install.log 2>&1; /usr/share/lyrah/installer/configure-session.sh plasma @@username@@ >> /var/log/lyrah-install.log 2>&1; echo \"=== [$(date)] Finished configure-session.sh (exit: $?) ===\" >> /var/log/lyrah-install.log 2>&1'"
  - "/bin/bash -c 'echo \"=== [$(date)] Starting post-install.sh ===\" >> /var/log/lyrah-install.log 2>&1; /usr/share/lyrah/installer/post-install.sh >> /var/log/lyrah-install.log 2>&1; echo \"=== [$(date)] Finished post-install.sh (exit: $?) ===\" >> /var/log/lyrah-install.log 2>&1'"
